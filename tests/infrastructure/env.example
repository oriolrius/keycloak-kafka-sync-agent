# ============================================================
# Keycloak-Kafka Testing Environment Configuration
# ============================================================
#
# This file documents all configurable values in docker-compose.yml.
# All values listed here are already set as defaults in docker-compose.yml.
#
# To customize any value:
# 1. Copy this file to .env (optional)
# 2. Uncomment the values you want to override
# 3. Restart the services: docker compose down && docker compose up -d
#
# Note: The docker-compose.yml works without a .env file.
# ============================================================

# ============================================================
# NETWORK CONFIGURATION
# ============================================================

# Docker network name for service communication
# Default: keycloak-kafka-backbone
# NETWORK_NAME=keycloak-kafka-backbone

# ============================================================
# PORT CONFIGURATION (HOST:CONTAINER)
# ============================================================
# All services use ports in the 57000 range to avoid conflicts

# KMS (Cosmian Key Management Service)
# Default: 57001:9998
# KMS_HOST_PORT=57001
# KMS_CONTAINER_PORT=9998

# Keycloak HTTP
# Default: 57002:8080
# KEYCLOAK_HTTP_HOST_PORT=57002
# KEYCLOAK_HTTP_CONTAINER_PORT=8080

# Keycloak HTTPS (uncomment SSL section in docker-compose.yml first)
# Default: 57003:8443
# KEYCLOAK_HTTPS_HOST_PORT=57003
# KEYCLOAK_HTTPS_CONTAINER_PORT=8443

# Kafka PLAINTEXT
# Default: 57004:9092
# KAFKA_PLAINTEXT_HOST_PORT=57004
# KAFKA_PLAINTEXT_CONTAINER_PORT=9092

# Kafka SSL (uncomment SSL section in docker-compose.yml first)
# Default: 57005:9093
# KAFKA_SSL_HOST_PORT=57005
# KAFKA_SSL_CONTAINER_PORT=9093

# ============================================================
# HOSTNAME CONFIGURATION
# ============================================================
# Service hostnames for internal communication and SNI

# KMS hostname
# Default: kms.example
# KMS_HOSTNAME=kms.example

# Keycloak hostname
# Default: keycloak.example
# KEYCLOAK_HOSTNAME=keycloak.example

# Kafka hostname
# Default: kafka.example
# KAFKA_HOSTNAME=kafka.example

# ============================================================
# KEYCLOAK CONFIGURATION
# ============================================================

# Keycloak admin credentials
# Default: admin / The2password.
# KEYCLOAK_ADMIN=admin
# KEYCLOAK_ADMIN_PASSWORD=The2password.

# Database configuration
# Default: SQLite with file at /opt/keycloak/data/keycloak.db
# KC_DB=sqlite
# KC_DB_URL=jdbc:sqlite:/opt/keycloak/data/keycloak.db

# Hostname settings
# KC_HOSTNAME_STRICT=false
# KC_HOSTNAME_STRICT_HTTPS=false

# Logging and metrics
# KC_LOG_LEVEL=INFO
# KC_METRICS_ENABLED=true
# KC_HEALTH_ENABLED=true

# SSL/TLS Configuration (after certificate generation)
# Uncomment these AND the HTTPS sections in docker-compose.yml
# KC_HTTPS_ENABLED=true
# KC_HTTPS_CERTIFICATE_FILE=/opt/keycloak/conf/keycloak.crt
# KC_HTTPS_CERTIFICATE_KEY_FILE=/opt/keycloak/conf/keycloak.key

# ============================================================
# KAFKA CONFIGURATION
# ============================================================

# KRaft cluster configuration
# Default: Single node (ID=1) with combined broker+controller role
# KAFKA_NODE_ID=1
# KAFKA_PROCESS_ROLES=broker,controller
# CLUSTER_ID=MkU3OEVBNTcwNTJENDM2Qk

# Controller configuration
# KAFKA_CONTROLLER_QUORUM_VOTERS=1@kafka.example:29093
# KAFKA_CONTROLLER_LISTENER_NAMES=CONTROLLER

# Listener configuration
# KAFKA_LISTENERS=PLAINTEXT://:9092,CONTROLLER://:29093,SSL://:9093
# KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://kafka.example:9092,SSL://kafka.example:9093
# KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT,CONTROLLER:PLAINTEXT,SSL:SSL
# KAFKA_INTER_BROKER_LISTENER_NAME=PLAINTEXT

# Replication settings (for single broker)
# KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1
# KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1
# KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=1
# KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS=0

# Storage
# KAFKA_LOG_DIRS=/var/lib/kafka/data

# SSL Configuration (after certificate generation)
# Uncomment these AND the SSL env vars in docker-compose.yml
# KAFKA_SSL_KEYSTORE_FILENAME=kafka_broker.keystore.jks
# KAFKA_SSL_KEYSTORE_CREDENTIALS=kafka_keystore_creds
# KAFKA_SSL_KEY_CREDENTIALS=kafka_ssl_key_creds
# KAFKA_SSL_TRUSTSTORE_FILENAME=kafka.truststore.jks
# KAFKA_SSL_TRUSTSTORE_CREDENTIALS=kafka_truststore_creds
# KAFKA_SSL_CLIENT_AUTH=none
# KAFKA_SSL_ENDPOINT_IDENTIFICATION_ALGORITHM=

# ============================================================
# CERTIFICATE CONFIGURATION
# ============================================================
# Used by certificate generation scripts

# Password for all certificates, keystores, and truststores
# MUST include the dot at the end: "The2password."
# Default: The2password.
# CERT_PASSWORD=The2password.
# KEYSTORE_PASSWORD=The2password.
# TRUSTSTORE_PASSWORD=The2password.

# Certificate subject information
# CERT_ORGANIZATION=Cosmian Test
# CERT_COUNTRY=ES

# Certificate validity
# CERT_VALIDITY_DAYS=365

# ============================================================
# VOLUME CONFIGURATION
# ============================================================
# All services use bind mounts (not Docker volumes)

# KMS data directory
# Default: ./data/kms
# KMS_DATA_DIR=./data/kms

# Keycloak data directory (SQLite database location)
# Default: ./data/keycloak
# KEYCLOAK_DATA_DIR=./data/keycloak

# Kafka data directory (logs and state)
# Default: ./data/kafka
# KAFKA_DATA_DIR=./data/kafka

# Certificates directory
# Default: ./certs
# CERTS_DIR=./certs

# ============================================================
# IMAGE CONFIGURATION
# ============================================================
# Docker image versions

# KMS image
# Default: ghcr.io/cosmian/kms:latest
# KMS_IMAGE=ghcr.io/cosmian/kms:latest

# Keycloak image
# Default: quay.io/keycloak/keycloak:26.0
# KEYCLOAK_IMAGE=quay.io/keycloak/keycloak:26.0

# Kafka image
# Default: apache/kafka:4.1.0
# KAFKA_IMAGE=apache/kafka:4.1.0

# ============================================================
# HEALTH CHECK CONFIGURATION
# ============================================================

# KMS health check
# Interval: 10s, Timeout: 5s, Retries: 5, Start period: 10s

# Keycloak health check
# Interval: 15s, Timeout: 5s, Retries: 10, Start period: 60s

# Kafka health check
# Interval: 10s, Timeout: 10s, Retries: 5, Start period: 30s

# ============================================================
# IMPORTANT NOTES
# ============================================================
#
# 1. PASSWORDS: All passwords are set to "The2password." (with the dot!)
#    This is for TESTING ONLY. Never use in production!
#
# 2. SSL SETUP: SSL is commented out by default in docker-compose.yml
#    After generating certificates with ./generate-certificates.sh:
#    - Uncomment SSL environment variables in docker-compose.yml
#    - Uncomment SSL port mappings in docker-compose.yml
#    - Restart services: docker compose restart
#
# 3. HOSTNAMES: Add these entries to /etc/hosts for proper resolution:
#    127.0.0.1  kms.example keycloak.example kafka.example
#
# 4. NETWORK: All services communicate via 'keycloak-kafka-backbone' network
#
# 5. LOGS: All container logs go to Docker console (not disk)
#    View with: docker logs <container> or docker compose logs -f
#
# 6. DATA PERSISTENCE: All data stored in ./data/ directory using bind mounts
#    - ./data/kms - KMS database and keys
#    - ./data/keycloak - Keycloak SQLite database
#    - ./data/kafka - Kafka logs and state
#
# ============================================================
# QUICK START
# ============================================================
#
# 1. Start KMS:
#    docker compose up -d kms
#
# 2. Generate certificates:
#    ./generate-certificates.sh
#
# 3. Enable SSL in docker-compose.yml (uncomment SSL sections)
#
# 4. Start all services:
#    docker compose up -d
#
# 5. Access services:
#    - KMS:        http://localhost:57001
#    - Keycloak:   https://localhost:57003 (admin/The2password.)
#    - Kafka:      localhost:57005 (SSL)
#
# ============================================================
